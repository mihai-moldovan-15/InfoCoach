{% extends "base.html" %}

{% block title %}InfoCoach Chat{% endblock %}

{% block extra_css %}
<!-- highlight.js pentru colorare sintaxÄƒ C++ -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-light.min.css">
{% endblock %}

{% block content %}
<div class="chat-container">
    <div class="chat-header">
        <h2>InfoCoach Chat</h2>
    </div>
    <div class="chat-messages" id="chat-messages">
        {% if user_input %}
        <div class="message user">
            <b>Tu:</b><br>
            {{ user_input }}
        </div>
        {% endif %}
        {% if output %}
        <div class="message assistant">
            <b>InfoCoach:</b>
            <div class="message-content">{{ output|safe }}</div>
            <form class="feedback-form" action="/feedback" method="post">
                <input type="hidden" name="user_input" value="{{ user_input }}">
                <input type="hidden" name="ai_response" value="{{ output }}">
                <input type="hidden" name="clasa" value="{{ clasa }}">
                <span>Acest rÄƒspuns a fost util?</span>
                <button type="submit" name="feedback" value="bun">âœ… Da</button>
                <button type="submit" name="feedback" value="rau">âŒ Nu</button>
            </form>
            <div id="feedback-message" style="display:none;">MulÈ›umim pentru feedback! ğŸ˜Š</div>
        </div>
        {% endif %}
    </div>
    <div class="chat-input-area">
        <div id="wait-message"></div>
        <form id="chat-form" onsubmit="return submitForm(event)" autocomplete="off">
            <div class="chat-input-row">
                <select name="clasa" id="clasa">
                    <option value="9" {% if clasa=='9' %}selected{% endif %}>Clasa a 9-a</option>
                    <option value="10" {% if clasa=='10' %}selected{% endif %}>Clasa a 10-a</option>
                    <option value="11-12" {% if clasa=='11-12' %}selected{% endif %}>Clasa a 11-a / a 12-a</option>
                </select>
                <textarea name="user_input" id="user-input" rows="2" placeholder="Scrie Ã®ntrebarea aici..."></textarea>
                <input type="submit" value="Trimite">
            </div>
        </form>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/cpp.min.js"></script>
<script>hljs.highlightAll();</script>
<script src="{{ url_for('static', filename='script.js') }}"></script>
{% endblock %}